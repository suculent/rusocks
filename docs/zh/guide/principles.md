# 工作原理

LinkSocks 主要运行在两种代理模式下，每种模式都为不同的网络场景而设计。

## 正向代理

正向代理允许服务器暴露其内部网络环境，同时保护其 IP 地址不被暴露。

首先，在一台能够托管网站并可从公共互联网访问的机器上启动 LinkSocks 服务器，并添加一个令牌。

然后，在需要访问服务器内部网络环境的设备上，启动 LinkSocks 客户端并使用令牌连接到指定的 URL。由于传输使用 WebSocket 协议，任何支持 WebSocket 的 Web 防火墙（如 Cloudflare）都可以用作中间层来保护服务器的 IP 地址不被暴露。

连接后，客户端将开放一个可配置的 SOCKS5 端口供其他服务连接。所有请求将通过建立的双向通道转发，服务器执行实际连接并发送数据。

![正向代理图](/forward_proxy_diagram.svg)

### 正向代理使用场景

- **访问受限网络**：通过中央服务器连接到内部服务
- **IP 保护**：在发出请求时隐藏您的真实 IP
- **绕过防火墙**：使用 WebSocket 传输绕过传统防火墙限制

## 反向代理

反向代理允许无法从公共互联网直接访问的设备暴露其内部网络环境。

首先，在一台能够托管网站并可从公共互联网访问的机器上启动 LinkSocks 服务器，并添加一个令牌。

然后，在内部网络服务器上启动 LinkSocks 客户端并使用令牌连接到指定的 URL。由于传输使用 WebSocket 协议，任何支持 WebSocket 的 Web 防火墙（如 Cloudflare）都可以用作中间层来保护服务器的 IP 不被暴露。

连接后，服务器将暴露一个 SOCKS5 端口供其他服务连接。所有请求将通过建立的双向通道转发，客户端执行实际连接并发送数据。

![反向代理图](/reverse_proxy_diagram.svg)

### 反向代理使用场景

- **内部网络访问**：访问没有公网 IP 地址的机器上的服务
- **负载均衡**：多个客户端可以提供网络访问并自动负载均衡
- **验证码解决**：使用多样化的客户端网络进行验证码解决和 IP 轮换
- **渗透测试**：在攻陷内部网络服务器后，直接向外渗透

## 技术优势

### WebSocket 传输

- **防火墙友好**：WebSocket 流量看起来像普通的 HTTP 流量
- **WAF 兼容**：可以通过 Web 应用防火墙（如 Cloudflare）工作
- **CDN 支持**：可以部署在 CDN 后面以增强安全性
- **SSL/TLS 支持**：使用 WSS 协议进行安全传输

### 动态客户端管理

- **无需配置**：客户端可以加入和离开而无需服务器重新配置
- **自动扩展**：系统根据可用的客户端容量进行扩展
- **负载均衡**：在可用客户端之间进行轮询分发
- **容错性**：客户端断开连接时自动故障转移

### 协议支持

- **完整的 SOCKS5**：完整的 SOCKS5 协议实现
- **身份验证**：基于令牌的身份验证以确保安全连接
- **IPv6 支持**：完整的 IPv6 连接支持
- **UDP 支持**：通过 SOCKS5 的 UDP 以提供全面的协议覆盖
